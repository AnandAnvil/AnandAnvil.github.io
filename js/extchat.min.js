!function(e){var t={};function a(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=t,a.d=function(e,t,o){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(a.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(o,n,function(t){return e[t]}.bind(null,n));return o},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=0)}([function(module,exports,__webpack_require__){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},setCookie=function(e,t,a){var o=new Date;o.setTime(o.getTime()+24*a*60*60*1e3);var n="expires="+o.toUTCString();document.cookie=e+"="+t+";"+n+";path=/"},buildChatMenu=function(e){var t="";(e.mainIcon&&$("#panicButton").removeClass().addClass(e.mainIcon),e.title&&$("#panicButton").attr("title",e.title),$("#chatMenuDropdown").remove(),e.menu)&&(e.menu.forEach(function(e){if(e.menus){var a="";e.menus.forEach(function(e){a+='<li><span class="'+(e.icon?e.icon:"")+'"></span><a tabindex="-1" href="#" data-display='+e.display+" data-alias="+(e.alias?e.alias:"")+">"+e.name+"</a></li>"}),t+='<li class="dropdown-header language-title"><span class="'+(e.icon?e.icon:"")+'">'+e.name+"</span>\n       </li>"+a}else t+='<li><span class="'+(e.icon?e.icon:"")+'"></span><a tabindex="-1" href="#" data-display='+e.display+" data-alias="+(e.alias?e.alias:"")+">"+e.name+"</a></li>"}),$('<div id="chatMenuDropdown" class="dropdown-content"><ul class="dropdown-menu">'+t+"</ul></div>").appendTo("header .chatActionIcons"),$("#panicButton").off("click"),$("li.has-submenu > a").on("click",function(e){e.stopPropagation(),e.preventDefault(),$(this).next("ul").toggle()}))};$("body").on("click",function(e){if(e.target.matches?e.target.matches("#panicButton"):e.target.msMatchesSelector("#panicButton"))$(this).find("#chatMenuDropdown").toggleClass("show");else{var t=$("#chatMenuDropdown");t.hasClass("show")&&(t.removeClass("show"),t.find("ul.dropdown-menu-child").hide())}});var getCookie=function(e){for(var t=e+"=",a=document.cookie.split(";"),o=0;o<a.length;o++){for(var n=a[o];" "==n.charAt(0);)n=n.substring(1);if(0==n.indexOf(t))return n.substring(t.length,n.length)}return""},checkCookie=function(){var e=getCookie("username");""!=e?console.log("Welcome again "+e):""!=(e=guid())&&null!=e&&setCookie("username",e,365)};$("body").on("click",".read-more-content",function(){$(this).parent(".long-content").addClass("view-full")});var GuestID=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()};function callAutoCompelete(e){destroyAuto();$("#message-to-send").autocomplete({source:e,minLength:0,mustMatch:!0,selectFirst:!0,autoFocus:!0,select:function(e,t){e.isDefaultPrevented()||console.log($("#message-to-send").val())},change:function(e,t){},position:{collision:"none",my:"left bottom",at:"left top"}}).keyup(function(){}).focus(function(){$("#message-to-send").data("ui-autocomplete")&&$("#message-to-send").autocomplete("search","")})}function destroyAuto(){$("#message-to-send").data("ui-autocomplete")&&$("#message-to-send").autocomplete("destroy")}function replaceURL(e){return e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(^|&lt;|\s)(www\..+?\..+?)(\s|&gt;|$)/g,'$1<a href="http://$2" target="_blank">$2</a>$3').replace(/(^|&lt;|\s)(((https?|ftp?|http):\/\/|mailto:).+?)(\s|&gt;|$)/g,'$1<a href="$2" target="_blank">$2</a>$5')}function linkify(e){var t,a,o,n=e,i=n.indexOf("open?id="),s=$.trim(n.substring(i+8));return-1!=i?"<div><iframe class='iframetrack' src=\"https://drive.google.com/file/d/"+s+'/preview" width="280" height="300"></iframe></div>':(t=/(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim,a=/(^|[^\/])(www\.[\S]+(\b|$))/gim,o=/(([a-zA-Z0-9\-\_\.])+@[a-zA-Z\_]+?(\.[a-zA-Z]{2,6})+)/gim,e.replace(t,'<a href="$1" target="_blank">$1</a>').replace(a,'$1<a href="http://$2" target="_blank">$2</a>').replace(o,'<a href="mailto:$1">$1</a>'))}var Runchat=function chatInit(conf){var $chat={user:{}};$chat.options=conf.options,$chat.device=conf.device?conf.device:"desktop",$chat.user.name=conf.options.userName?conf.options.userName:"Me",$chat.headerToken=conf.options.token?conf.options.token:"",$chat.saveLogs=!conf.options.hasOwnProperty("saveLogs")||conf.options.saveLogs,$chat.user.messageAgent="Workflow",$chat.user.guid=void 0!==conf.vizData&&conf.vizData?conf.vizData.email+"_domain_"+conf.clientDomain:GuestID(),$chat.workflowUserId=conf.userId,$chat.workflows=conf.Id,$chat.workflowName=Object.keys($chat.workflows)[0],$chat.workflowId=$chat.workflows[$chat.workflowName],$chat.heading=$chat.workflowName,$chat.description=conf.options.description?conf.options.description:"",$chat.botName=$chat.workflowName,$chat.tid=conf.tid,$chat.logdomain=conf._tdomain,$chat.domain=conf._tdomain,$chat.SocketDomain=conf.SocketDomain,$chat.options.attachment=void 0===$chat.options.attachment||$chat.options.attachment,conf.chatInternalCall&&$("body").addClass("vizappchat");var chatOptions={socketConnect:!1,connection:!1,fileAttached:!1,notReceivedMsg:0,fileReceived:!0,dropzone:!1,dropfiles:[],presentFile:0,timer:0,msg:""},SCRIPT_REGEX=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi;console.log("chatObj:::",$chat);var Heading=$chat.heading+"<small>"+$chat.description+"</small>",socketObj;$("#custColLeft h3").html(Heading);var customDiv={typing:'<section id="typingIndication"><label>'+$chat.botName+'</label><b><img src="../../../ui-themes/karma/images/chat_typing-dots-speed-2.gif"></b></section>',notDelivered:'<i class="not-deliver">your message was not delivered</i>'},fileAttachData,setOptions_Func=function(){$chat.options.attachment||$("#msg_footer .fileContainer").hide(),$("#message-to-send").attr("placeholder",$chat.options.textareaPlaceholder?$chat.options.textareaPlaceholder:"Type a Message"),$chat.options.helpBtn||$("#panicButton").hide(),$chat.options.helpBtnTooltip&&$("#panicButton").attr("title",$chat.options.helpBtnTooltip),$chat.options.menuConf&&("string"==typeof $chat.options.menuConf?buildChatMenu(JSON.parse($chat.options.menuConf)):buildChatMenu($chat.options.menuConf))};setOptions_Func();var ConnectSocket_Func=function(){ErrorMsg_Func({show:!0,message:"Connecting to server"});var e=io.connect($chat.SocketDomain,{query:"token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJkb21haW4iOiJ2aXpydSIsIm5hbWUiOiJHdWVzdCIsImFnZW50IjoiV29ya2Zsb3cifQ.bDuKpCe3ql1OjELAwZJG6GW89Y84mfYZedqc9CI8P1U"});e.on("connect",function(){socketObj=this,chatOptions.connection=!0,ErrorMsg_Func({show:!1}),e.emit("set_user",{user:"Guest",tid:$chat.tid,guid:$chat.user.guid,connectedWorkflow:$chat.workflows,domain:$chat.domain,workflowId:$chat.workflowId,headerToken:$chat.headerToken,saveLogs:$chat.saveLogs,device:$chat.device,logdomain:$chat.logdomain,apiUserId:$chat.workflowUserId}),console.log("socketid:::",e.io.engine.id),chatOptions.socketConnect||(chatOptions.socketConnect=!0,e.emit("get_flowmessages",{to:$chat.user.guid,from:$chat.workflowId,tid:$chat.tid,logdomain:$chat.logdomain,Agent:$chat.user.messageAgent,userId:$chat.workflowUserId}))}),ChatLogic_Func(e)},ChatLogic_Func=function ChatLogic_Func(socket){socket.on("new_message",function(data){if(console.log("new_message:::",data),data.menuConf&&(data.menuConf=JSON.parse(data.menuConf),buildChatMenu(data.menuConf)),data.jsCode)if("parent"===data.exeContext)window.parent.postMessage({exeContext:"parent",jsCode:data.jsCode},"*");else{var sentData=eval(data.jsCode);SentMessage_Func({msg:"/data",display:!1,data:sentData})}function endAndStartTimer(){window.clearTimeout(chatOptions.timer),chatOptions.timer=window.setTimeout(function(){SentMessage_Func({msg:"/timeout",display:!1})},data.timer)}if(data.timer?endAndStartTimer():window.clearTimeout(chatOptions.timer),"/null"!=data.Body){"/stop"!=data.Body&&$("#typingIndication").remove();var attachment=void 0===data.showAttachment?$chat.options.attachment:parseInt(data.showAttachment);if(attachment?$("#msg_footer .fileContainer").show():$("#msg_footer .fileContainer").hide(),data.hasOwnProperty("showTextarea")&&"0"==data.showTextarea?$("#message-to-send").attr("disabled",!0):$("#message-to-send").attr("disabled",!1),chatOptions.notReceivedMsg&&($(".not-deliver").last().remove(),chatOptions.notReceivedMsg--),""!=data.Body){var time=getTime_Func();"Admin"==data.from&&(data.Body=data.message);var MessageBody=data.Body;if(-1==MessageBody.indexOf("<div")&&(MessageBody=linkify(MessageBody)),!$($.parseHTML(MessageBody)).hasClass("card")){MessageBody=MessageBody.replace("[","<br/>["),MessageBody=MessageBody.replace(/]/g,"</a>"),MessageBody=MessageBody.replace(/\[/g,"<a class='returntext button'>");var autosuggestList="";autosuggestList=MessageBody.split("|"),Array.isArray(autosuggestList)&&(MessageBody=autosuggestList.shift(),callAutoCompelete(autosuggestList))}MessageBody=MessageBody.split("/repost").map(function(e){return e.trim()});var delayTime=0;MessageBody.map(function(msg,i){chatOptions.msg=msg,setTimeout(function(){$("#typingIndication").remove();var message_div=buildDiv_Func("other",msg,time);message_div.find(".card").length&&message_div.find(".thread").addClass("hasCard"),message_div.find(".drop-zone").length&&(chatOptions.dropzone=!0),$("#messageBody").append(message_div).find(".sliderOverflowwrap").cardSlider(),MessageBody.length-1!=i&&showTyping_Func(),scrollToBottom(),data.jsCodes&&eval(data.jsCodes[0])},delayTime),delayTime+=1e3})}}else $("#typingIndication").remove()}),socket.on("get_flowmessages",function(e){console.log("logs:::",e);var t=null===e?0:e.length;if(0==t){var a=$chat.options.startupText?$chat.options.startupText:"Hi";SentMessage_Func({msg:a,display:!1})}if(t>0){for(var o in clearChatHistory(),(e=e.reverse()).length>50&&e.splice(0,50),e){var n=e[o],i=getTime_Func(n["created-at"]),s=n.body;-1==s.indexOf("<div")&&(s=linkify(s)),$($.parseHTML(s)).hasClass("card")||(s=(s=s.replace(/]/g,"</a>")).replace(/\[/g,"<a class='returntext button'>")),(s=s.split("/repost").map(function(e){return e.trim()})).map(function(t){var a;(a=e[o].from==$chat.user.guid?buildDiv_Func("guest",t,i):buildDiv_Func("other",t,i)).find(".card").length&&a.find(".thread").addClass("hasCard"),$("#messageBody").append(a)})}SentMessage_Func({msg:"/reopen",display:!1})}$("#messageBody").find(".hasCard input:radio:not(:disabled)").attr("disabled",!0),$("#messageBody").find(".getchatvalue[type='radio']:enabled").attr("disabled",!0),$("#messageBody").find("a.returntext:not(.disabled), .getchatvalue, .returnVal:not(.disabled)").addClass("disabled"),$(".msgBody section").is(":last-child")&&($(".msgBody section:last").find("a.returntext, .getchatvalue, .returnVal").removeClass("disabled"),$(".msgBody section:last").find(".hasCard input:radio, .getchatvalue[type='radio']").removeAttr("disabled")),scrollToBottom()});var showTyping_Func=function(){$("#typingIndication").remove(),$("#messageBody").append(customDiv.typing),scrollToBottom()};socket.on("showTyping",function(e){showTyping_Func()}),socket.on("clear_history",function(e){$("#messageBody").empty();var t=$chat.options.startupText?$chat.options.startupText:"/start";SentMessage_Func({msg:t,display:!1})}),socket.on("file_received",function(e){chatOptions.fileReceived=!0}),socket.on("disconnect",function(){if(chatOptions.connection=!1,!chatOptions.fileReceived){var e=getTime_Func(),t=buildDiv_Func("other","There was an error in uploading your file. Please try again",e);$("#messageBody").append(t),scrollToBottom(),chatOptions.fileReceived=!0}ErrorMsg_Func({show:!0,message:"Your conversation is offline"})})},ErrorMsg_Func=function(e){!0===e.show?($(".errorMessage").text(e.message),$(".errorMessage").show()):$(".errorMessage").hide()},buildDiv_Func=function(e,t,a){return"guest"==e?$("<article><label>"+$chat.user.name+'</label><div class="thread">'+t+'</div><span class="time">'+(chatOptions.connection?"":customDiv.notDelivered)+a+"</span></article>"):$("<section><label>"+$chat.botName+'</label><div class="thread">'+$.trim(t).replace(/\u200B/g,"")+'</div><span class="time">'+a+"</span></section>")},SentMessage_Func=function(e){chatOptions.fileAttached&&sentFile_Func(fileAttachData);for(var t,a=e.msg||$("#message-to-send").val();SCRIPT_REGEX.test(a);)a=a.replace(SCRIPT_REGEX,"");a=a.replace(/\n/g,"</br>");var o=getTime_Func();"/"!=a.charAt(0)||e.msg||(a="",$("#message-to-send").val(""),t=buildDiv_Func("other","messages starting with slash are reserved",o),$("#messageBody").append(t),scrollToBottom());if(_.contains(["/help","/timeout","/data","/reopen","/start"],a)||"/"!=a.charAt(0)||(a=""),chatOptions.fileAttached)sentFile_Func(fileAttachData);else if(""!=a){var n={from:$chat.user.guid,workflowId:$chat.workflowId,Body:e.alias||a,domain:$chat.domain,device:$chat.device,tid:$chat.tid,Agent:$chat.user.messageAgent,logdomain:$chat.logdomain,userId:$chat.workflowUserId};e.data&&(n.data=JSON.stringify(e.data)),console.log("msg_data:::",n),chatOptions.socketConnect&&0==chatOptions.connection&&chatOptions.notReceivedMsg++,a=replaceURL(a),a=$.parseHTML(a)[0].data,t=buildDiv_Func("guest",a,o),$("#typingIndication").remove(),e.display&&$("#messageBody").append(t),e.msg||$("#message-to-send").val(""),scrollToBottom(),socketObj.emit("workflow_trigger",n)}};$("#message-to-send").keydown(function(e){if(13==(e.keyCode||e.which)&&e.shiftKey);else if(1!=$(".tribute-container").is(":visible")&&13==(e.keyCode||e.which))if(e.preventDefault(),$("#message-to-send").data("ui-autocomplete")){if(1==$(".ui-widget-content.ui-autocomplete:visible").length)return;SentMessage_Func({display:!0})}else SentMessage_Func({display:!0})}),$("#cutomSendBtn").click(function(e){SentMessage_Func({display:!0})});var getTime_Func=function(e){return e?moment(e).isSame(moment(),"day")?moment(e).format("hh:mm A")+", Today":moment(e).format("Do MMMM hh:mm A"):(new Date).toLocaleString("en-IN",{hour:"numeric",minute:"numeric",hour12:!0})+", Today"},clearFileInput=function(){$("#chatFileInput").val(null),$("#file-upload_footer li")[0].childNodes[0].data="",$("#file-upload_footer").removeClass("active"),$("#msg_footer").show(),fileAttachData="",chatOptions.fileAttached=!1},clearChatHistory=function(){$("#messageBody").empty()},scrollToBottom=function(){var e=document.getElementById("messageBody");window.setTimeout(function(){$(e).animate({scrollTop:e.scrollHeight-e.clientHeight},50)},0),chatOptions.dropzone&&addListener("drop-zone")},dropDownValues;function getMsgObj(e){var t=!$(e).get(0).hasAttribute("data-display")||"false"!=$(e).data("display").toString(),a=$(e).data("value")?$(e).data("value"):$(e).text();return $(e).data("alias")?{msg:a,display:t,alias:$(e).data("alias")}:{msg:a,display:t}}function addListener(e){var t=$(".hasCard").last().has(".drop-zone");dropDownValues=t.find(".card").attr("data-dropdown");var a=t.find(".card").attr("data-tags");dropDownValues&&(dropDownValues=JSON.parse(dropDownValues)),$(".drop-zone").last().on("drop",function(e){e.originalEvent.dataTransfer&&e.originalEvent.dataTransfer.files.length&&(e.preventDefault(),e.stopPropagation(),chatOptions.dropfiles=chatOptions.dropfiles.concat(Array.from(Object.values(e.originalEvent.dataTransfer.files))),buildFileUpload(chatOptions.dropfiles,dropDownValues,a))}),t.find("input").on("change",function(e){e.target.files&&e.target.files.length&&(chatOptions.dropfiles=chatOptions.dropfiles.concat(Array.from(Object.values(e.target.files))),buildFileUpload(chatOptions.dropfiles,dropDownValues,a))}),$(".drop-zone").last().on("click",function(){t.find("input").click()}),t.find(".filesRemove").on("click",function(e){chatOptions.dropfiles.splice($(this).closest(".file-item").data("fileno"),1),1==$(".thread .file-item").length?(chatOptions.dropzone=!0,t.find(".file-btns").hide(),$(this).closest(".file-item").remove(),t.find(".drop-zone").show()):$(this).closest(".file-item").remove()}),$(".save-upload").last().click(function(){for(var e=0;e<chatOptions.dropfiles.length;e++){var a=t.find(".file-"+e),o=a.find(".file-category").val();t.find(".tag span[data-role=remove]").remove(),t.find("button").remove(),$(".file-item").find(".filesRemove").remove(),a.find(".file-categorySelect").append('<div class="category-selected">'+o+"</div>")}t.find(".file-itemWrap").addClass("started"),t.find(".drop-zone.card").hide(),uploadDocuments(t)}),$(".cancel-upload").last().click(function(){chatOptions.dropzone=!0,chatOptions.dropfiles=[],t.find(".file-item").remove(),t.find(".file-btns.right").remove(),t.find(".drop-zone").show()})}function buildFileUpload(e,t,a){var o="",n="";if(t&&t.length>1){var i=t.map(function(e){return"<option value='"+e+"'></option>"});o='<div class="file-item-fields category"><span class="file-icon"><i class="icon-file-form"></i></span><span class="file-categorySelect"><input type="text" class="form-control file-category" placeholder="Category" list="options" /><datalist id="options">'+i+"</datalist></span></div>"}Boolean(a)&&(n='<div class="file-item-fields file-tags"><span class="file-icon"><i class="icon-enable-tag"></i></span><span class="file-tagInput"><input type="text" placeholder="Add tag" class="form-control file-tag" data-role="tagsinput"/></span></div>');var s=$(".hasCard").last().has(".drop-zone"),c=s.find(".card").attr("data-button_text");c=c?JSON.parse(c):["Save and Upload","Cancel All"];var r="";e.map(function(e,t){var a='<div class="file-item file-'+t+'" data-fileNo='+t+'><span class="filesRetry">File upload failed. retry <i class="icon-autorenew"></i></span>\n      <span class="filesRemove"><i class="icon-close-thick"></i></span><span class="filesUploaded"><i class="icon-tick"></i></span>\n    <div class="file-itemsBox"><div class="file-item-fields"><span class="file-icon"><i class="icon-file-document"></i></span><span class="file-name" title="'+e.name+'">'+e.name+"</span></div>\n    "+o+n+'\n    </div>\n    <div class="progress">\n      <div class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0"\n      aria-valuemin="0" aria-valuemax="100" style="width:0%">\n      </div>\n    </div>\n    </div>';r+=a}),$(".drop-zone").last().remove(),$('.hasCard input[type="file"]').last().remove();var l='<div class="file-itemWrap">'+r+chatOptions.msg+'<div class="file-btns right"><button type="button" class="save-upload chatActionBtn">'+c[0]+'</button><button type="button" class="cancel-upload chatActionBtn">'+c[1]+"</button></div></div>";s.find(".file-itemWrap").remove(),s.prepend(l),s.find(".file-tag").tagsinput({confirmKeys:[13,44]}),chatOptions.dropzone=!1,addListener()}function uploadDocuments(e){var t=chatOptions.dropfiles[chatOptions.presentFile],a=dropDownValues&&1==dropDownValues.length?dropDownValues[0]:e.find(".file-category").eq(chatOptions.presentFile).val(),o=conf.clientDomain&&conf.clientDomain===$chat.domain?"workflow.exec":"workflow.trigger",n=e.find(".file-tag").eq(chatOptions.presentFile).tagsinput("items")||[],i=new FormData;i.append("file",t,t.name),i.append("from",$chat.user.guid),i.append("currentFile",chatOptions.presentFile+1),i.append("totalFile",chatOptions.dropfiles.length),i.append("Body","/file"),i.append("device",$chat.device),i.append("Agent","Workflow"),i.append("headerToken",$chat.headerToken),i.append("fileCategory",a),i.append("fileTag",n),e.find("input").hide(),$.ajax({url:"https://"+$chat.domain+"/"+o+"/"+$chat.workflowId,type:"POST",contentType:!1,cache:!1,processData:!1,data:i,xhr:function(){var t=$.ajaxSettings.xhr();return(t.upload||t).addEventListener("progress",function(t){var a=t.position||t.loaded,o=t.totalSize||t.total,n=Math.round(a/o*100);e.find(".progress-bar").eq(chatOptions.presentFile).css("width",n+"%")}),t},beforeSend:function(){e.find(".progress").eq(chatOptions.presentFile).show()},success:function(t,a,o){e.find("[data-fileno='"+chatOptions.presentFile+"']").addClass("uploadSuccess"),e.find(".progress").eq(chatOptions.presentFile).hide(),e.find("[data-fileno='"+chatOptions.presentFile+"'] .filesUploaded").show(),chatOptions.dropfiles.length===chatOptions.presentFile+1?(chatOptions.presentFile=0,chatOptions.dropfiles=[],chatOptions.dropzone=!1,socketObj.emit("resend_msg",{Body:t[0],tid:$chat.tid}),$("#message-to-send").attr("disabled",!1)):chatOptions.presentFile++,chatOptions.dropfiles.length>chatOptions.presentFile&&uploadDocuments(e)},error:function(t,a){e.find("[data-fileno='"+chatOptions.presentFile+"']").addClass("uploadError"),e.find(".progress").eq(chatOptions.presentFile).hide(),e.find("[data-fileno='"+chatOptions.presentFile+"'] .filesRetry").show(),e.find(".filesRetry").on("click",function(){$(this).hide(),uploadDocuments(e)})}})}function readFile(e){var t=e.target.files;console.log("files:::",t);var a=t[0],o=URL.createObjectURL(a),n=new FileReader;n.onload=function(e){$("#msg_footer").hide(),$("#file-upload_footer").addClass("active"),$("#file-upload_footer li").prepend(a.name),chatOptions.fileAttached=!0;var t={from:$chat.user.guid,workflowId:$chat.workflowId,Body:"/file",domain:$chat.domain,device:$chat.device,tid:$chat.tid,Agent:"Workflow",userId:$chat.workflowUserId,fileRaw:e.target.result,src:o,filename:a.name,fileType:a.type,comment:$("#message-to-send").val()};fileAttachData=t,$("#message-to-send").focus()},n.readAsDataURL(a)}$("#chatFileInput").on("change",readFile),$("body").on("click","#chatMenuDropdown a",function(e){var t=getMsgObj(this);SentMessage_Func(t)}),$("body").on("click","input.returntext[type='radio']:enabled",".getchatvalue[type='radio']:enabled",function(){var e=getMsgObj(this);SentMessage_Func(e),$(this).parentsUntil(".card").find("[type='radio']").prop("disabled",!0)}),$("body").on("click","a.returntext:not(.disabled), .getchatvalue, .returnVal:not(.disabled)",function(){var e=$(this).closest(".thread").find("select.data-select-field");$(this).hasClass("button")&&($(this).closest(".thread").find(".returntext, .returnVal, .getchatvalue").addClass("disabled"),e.length&&($(this).data("value",e.val()),e.attr("disabled","disabled")));var t=getMsgObj(this);SentMessage_Func(t)}),$("#file-upload_footer input.btn.btn-green").on("click",function(){sentFile_Func(fileAttachData)}),$("#file-upload_footer ul li span").on("click",function(){clearFileInput()}),$("#file-upload_footer input.btn.btn-grey").on("click",function(){clearFileInput()});var sentFile_Func=function(e){chatOptions.fileReceived=!1,socketObj.emit("sent_file",e);$("#typingIndication").remove();var t,a=getTime_Func();t=$.inArray(e.fileType,["image/gif","image/jpeg","image/png"])>0?"<article><label>"+$chat.user.name+'</label><div class="thread"><div class="card picture-card"><figure><img src="'+e.src+'" alt="" width="100%"><figcaption>'+e.comment+'</figcaption></figure></div></div><span class="time">'+(chatOptions.connection?"":customDiv.notDelivered)+a+"</span></article>":$.inArray(e.fileType,["video/ogg","video/mp4","video/webm"])>0?"<article><label>"+$chat.user.name+'</label><div class="thread"><div class="card video-card">\n        <video id="playerA" controls aposter="../../../ui-themes/karma/images/chat_video-poster.svg" onclick="this.play()"><source src="'+e.src+'" type="'+e.fileType+'"></video>\n        <p>'+e.comment+'</p></div></div><span class="time">'+(chatOptions.connection?"":customDiv.notDelivered)+a+"</span></article>":"<article><label>"+$chat.user.name+'</label><div class="thread"><p><i class="fa fa-paperclip" aria-hidden="true"></i>'+e.filename+"<br>"+e.comment+'</p></div><span class="time">'+(chatOptions.connection?"":customDiv.notDelivered)+a+"</span></article>",$("#messageBody").append(t),clearFileInput(),$("#message-to-send").val(""),scrollToBottom()};$("#panicButton").click(function(){$chat.options.menuConf||SentMessage_Func({msg:"/help",display:!1})}),window.addEventListener("message",function(e){"object"==_typeof(e.data)&&"sendValue"==e.data.call&&SentMessage_Func({msg:"/data",display:!1,data:e.data.data})},!1),ConnectSocket_Func()};$(document).ready(function(){Runchat(Conf)}),window.addEventListener("dragover",function(e){(e=e||event).preventDefault()},!1),window.addEventListener("drop",function(e){(e=e||event).preventDefault()},!1),function(e){e.fn.cardSlider=function(t){e(this).each(function(){var t=e(this);function a(e){var a=t.scrollTop();t.stop().animate({scrollTop:a+e},350,"swing")}t.find(".upClick").click(function(){a(-170)}),t.find(".downClick").click(function(){a(170)})})}}(jQuery)}]);